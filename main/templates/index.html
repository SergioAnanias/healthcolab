{% extends "base.html" %}
{% block titulo %} Home {% endblock %}

{% block script %}

{% endblock %}

{% block content %}
<h3 class="text-center">Bienvenido {{ usuario.nombres }} {{usuario.apellidos}}</h3>


<h2 class="text-center">Agenda del {{ lunes | date:'d-m-Y' }} al {{domingo| date:'d-m-Y' }} </h2>


<table id="agenda">
    <thead>
        <td>RUT</td>
        <td>Nombres</td>
        <td>Apellidos</td>
        <td>Dirección</td>
        <td>Numero contacto</td>
        <td>Fecha</td>
        <td>Hora</td>
        <td>Estado</td>
    </thead>
    <tbody>
        {% for agenda in agendamientos %}
        <tr>
            <td>{{agenda.pacientes_rut.rut}}</td>
            <td>{{agenda.pacientes_rut.nombre}}</td>
            <td>{{agenda.pacientes_rut.apellidos}}</td>
            <td>{{agenda.pacientes_rut.direccion}}</td>
            <td>{{agenda.pacientes_rut.telefono}}</td>
            <td>{{agenda.fecha}}</td>
            <td>{{agenda.hora}}</td>
            <td>
                {{agenda.estado_idestado.desc_estado}}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
<div id="chartDiv" style="max-width: 740px;height: 400px;margin: 0px auto">
</div>



{% load static %}
<script src="{% static 'js/index.js' %}">
</script>
<script>
    var chart = JSC.chart('chartDiv', {
        debug: true,
        type: 'column',
        yAxis: {
            scale_type: 'stacked',
            label_text: 'Agenda'
        },
        title_label_text: 'Mes N°{{dt | date:'m'}} del {{dt|date:'Y'}}',
        xAxis: {
            label_text: 'Ultimos 4 meses',
            categories: [{% for month in months %} '{{month | date:'m'}}', {%endfor%}]
        },
        series: [
            {
                name: 'Agendados',
                points: [{% for agendado in agendados %} {{agendado}}{% if forloop.last != true %}, {% endif %} {%endfor%}]
            },
            {
                name: 'Confirmado',
                points: [{% for confirmado in confirmados %} {{confirmado}}{% if forloop.last != true %}, {% endif %}  {%endfor%}]
            },
            {
                name: 'Realizados',
                points: [{% for realizado in realizados %} {{realizado}} {% if forloop.last != true %}, {% endif %} {%endfor%}]
            },
            {
                name: 'Cancelados',
                points: [{% for cancelado in cancelados %} {{cancelado}} {% if forloop.last != true %}, {% endif %}  {%endfor%}]
            }
        ]
    });
</script>
{% endblock %}